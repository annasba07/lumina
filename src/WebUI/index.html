<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lumina - Ultra-minimal Transcription</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            -webkit-font-smoothing: antialiased;
        }

        /* Glassmorphism effects */
        .glass {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .glass-dark {
            background: rgba(20, 20, 20, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        /* Smooth animations */
        @keyframes pulse-soft {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(0.98); }
        }

        @keyframes slide-up {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .animate-pulse-soft {
            animation: pulse-soft 2s ease-in-out infinite;
        }

        .animate-slide-up {
            animation: slide-up 0.3s ease-out;
        }

        /* Modern scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 0, 0, 0.3);
        }

        /* Gradient backgrounds */
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 transition-colors duration-300">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Main App Component
        function LuminaApp() {
            const [isRecording, setIsRecording] = useState(false);
            const [transcription, setTranscription] = useState('');
            const [mode, setMode] = useState('quick');
            const [isProcessing, setIsProcessing] = useState(false);
            const [partialText, setPartialText] = useState('');
            const [audioLevel, setAudioLevel] = useState(0);
            const [isDark, setIsDark] = useState(false);

            // Modes configuration
            const modes = {
                quick: { name: 'Quick', icon: '‚ö°', color: 'blue' },
                meeting: { name: 'Meeting', icon: 'üë•', color: 'green' },
                code: { name: 'Code', icon: 'üíª', color: 'purple' },
                medical: { name: 'Medical', icon: 'üè•', color: 'red' }
            };

            // Handle recording
            const handleRecord = async () => {
                if (!isRecording) {
                    setIsRecording(true);
                    setPartialText('');
                    // Call C# backend
                    if (window.lumina) {
                        await window.lumina.startRecording();
                    }
                } else {
                    setIsRecording(false);
                    setIsProcessing(true);
                    if (window.lumina) {
                        const result = await window.lumina.stopRecording();
                        setTranscription(prev => prev + (prev ? '\n\n' : '') + result);
                    }
                    setIsProcessing(false);
                }
            };

            return (
                <div className="min-h-screen flex flex-col">
                    {/* Title Bar */}
                    <div className="glass dark:glass-dark border-b border-gray-200 dark:border-gray-700 px-4 py-3 flex items-center justify-between select-none"
                         style={{WebkitAppRegion: 'drag'}}>
                        <div className="flex items-center space-x-3">
                            <div className="w-8 h-8 gradient-bg rounded-lg flex items-center justify-center">
                                <span className="text-white text-sm font-bold">L</span>
                            </div>
                            <span className="font-semibold text-gray-900 dark:text-white">Lumina</span>

                            {/* Mode Selector */}
                            <select
                                value={mode}
                                onChange={(e) => setMode(e.target.value)}
                                className="ml-4 px-3 py-1 rounded-lg bg-gray-100 dark:bg-gray-800 text-sm"
                                style={{WebkitAppRegion: 'no-drag'}}>
                                {Object.entries(modes).map(([key, config]) => (
                                    <option key={key} value={key}>
                                        {config.icon} {config.name}
                                    </option>
                                ))}
                            </select>
                        </div>

                        <div className="flex items-center space-x-2" style={{WebkitAppRegion: 'no-drag'}}>
                            <button
                                onClick={() => setIsDark(!isDark)}
                                className="p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition-colors">
                                {isDark ? 'üåû' : 'üåô'}
                            </button>
                            <button className="p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition-colors">
                                ‚ûñ
                            </button>
                            <button className="p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition-colors">
                                ‚úñÔ∏è
                            </button>
                        </div>
                    </div>

                    {/* Main Content */}
                    <div className="flex-1 flex flex-col p-6">
                        {/* Transcription Area */}
                        <div className="flex-1 mb-6">
                            {transcription || partialText ? (
                                <div className="h-full">
                                    <div className="glass dark:glass-dark rounded-2xl p-6 h-full overflow-y-auto">
                                        <div className="prose dark:prose-invert max-w-none">
                                            {transcription && (
                                                <p className="text-gray-900 dark:text-gray-100 whitespace-pre-wrap animate-slide-up">
                                                    {transcription}
                                                </p>
                                            )}
                                            {partialText && (
                                                <p className="text-gray-500 dark:text-gray-400 italic animate-pulse-soft">
                                                    {partialText}
                                                </p>
                                            )}
                                        </div>
                                    </div>
                                </div>
                            ) : (
                                <div className="h-full flex items-center justify-center">
                                    <div className="text-center">
                                        <div className="w-20 h-20 mx-auto mb-4 gradient-bg rounded-full flex items-center justify-center animate-pulse-soft">
                                            <span className="text-3xl">üéôÔ∏è</span>
                                        </div>
                                        <h3 className="text-xl font-semibold text-gray-900 dark:text-white mb-2">
                                            Ready to transcribe
                                        </h3>
                                        <p className="text-gray-500 dark:text-gray-400">
                                            Press <kbd className="px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded">Alt+Shift+R</kbd> or click below to start
                                        </p>
                                    </div>
                                </div>
                            )}
                        </div>

                        {/* Action Bar */}
                        <div className="glass dark:glass-dark rounded-2xl p-4">
                            <div className="flex items-center justify-between">
                                <div className="flex items-center space-x-3">
                                    {/* Audio Level Indicator */}
                                    {isRecording && (
                                        <div className="flex items-center space-x-1 animate-slide-up">
                                            {[...Array(5)].map((_, i) => (
                                                <div
                                                    key={i}
                                                    className={`w-1 h-${Math.random() * 16 + 4} bg-gradient-to-t from-purple-500 to-blue-500 rounded-full transition-all duration-100`}
                                                />
                                            ))}
                                        </div>
                                    )}

                                    {/* Status */}
                                    {isRecording && (
                                        <span className="text-sm text-red-500 font-medium animate-pulse">
                                            Recording...
                                        </span>
                                    )}
                                    {isProcessing && (
                                        <span className="text-sm text-blue-500 font-medium animate-pulse">
                                            Processing...
                                        </span>
                                    )}
                                </div>

                                <div className="flex items-center space-x-3">
                                    {/* Action Buttons */}
                                    {transcription && (
                                        <>
                                            <button className="px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition-all">
                                                üìã Copy
                                            </button>
                                            <button className="px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition-all">
                                                üíæ Export
                                            </button>
                                            <button className="px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition-all">
                                                üóëÔ∏è Clear
                                            </button>
                                        </>
                                    )}

                                    {/* Record Button */}
                                    <button
                                        onClick={handleRecord}
                                        disabled={isProcessing}
                                        className={`px-6 py-3 rounded-xl font-medium transition-all transform hover:scale-105 active:scale-95 ${
                                            isRecording
                                                ? 'bg-red-500 text-white animate-pulse'
                                                : 'gradient-bg text-white'
                                        }`}>
                                        {isRecording ? '‚èπÔ∏è Stop' : 'üéôÔ∏è Record'}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Status Bar */}
                    <div className="glass dark:glass-dark border-t border-gray-200 dark:border-gray-700 px-4 py-2 flex items-center justify-between text-xs text-gray-500 dark:text-gray-400">
                        <div className="flex items-center space-x-4">
                            <span>Mode: {modes[mode].icon} {modes[mode].name}</span>
                            <span>‚Ä¢</span>
                            <span>Model: Base (141MB)</span>
                            <span>‚Ä¢</span>
                            <span>Ready</span>
                        </div>
                        <div>
                            {transcription && (
                                <span>{transcription.split(' ').length} words</span>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        // Render the app
        ReactDOM.render(<LuminaApp />, document.getElementById('root'));
    </script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</body>
</html>